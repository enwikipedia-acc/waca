/******************************************************************************
 * Wikipedia Account Creation Assistance tool                                 *
 * ACC Development Team. Please see team.json for a list of contributors.     *
 *                                                                            *
 * This is free and unencumbered software released into the public domain.    *
 * Please see LICENSE.md for the full licencing statement.                    *
 ******************************************************************************/

DROP PROCEDURE IF EXISTS SCHEMA_UPGRADE_SCRIPT;
DELIMITER ';;'
CREATE PROCEDURE SCHEMA_UPGRADE_SCRIPT() BEGIN
    -- -------------------------------------------------------------------------
    -- Developers - set the number of the schema patch here!
    -- -------------------------------------------------------------------------
    DECLARE patchversion INT DEFAULT 34;
    -- -------------------------------------------------------------------------
    -- working variables
    DECLARE currentschemaversion INT DEFAULT 0;
    DECLARE lastversion INT;
	
    -- check the schema has a version table
    IF NOT EXISTS (SELECT * FROM information_schema.tables WHERE table_name = 'schemaversion' AND table_schema = DATABASE()) THEN
        SIGNAL SQLSTATE '45000' SET message_text = 'Please ensure patches are run in order! This database does not have a schemaversion table.';
    END IF;
    
    -- get the current version
    SELECT version INTO currentschemaversion FROM schemaversion;
    
    -- check schema is not ahead of this patch
    IF currentschemaversion >= patchversion THEN
        SIGNAL SQLSTATE '45000' SET message_text = 'This patch has already been applied!';
    END IF;
    
    -- check schema is up-to-date
    SET lastversion = patchversion - 1;
    IF currentschemaversion != lastversion THEN
		SET @message_text = CONCAT('Please ensure patches are run in order! This patch upgrades to version ', patchversion, ', but the database is not version ', lastversion);
        SIGNAL SQLSTATE '45000' SET message_text = @message_text;
    END IF;

    -- -------------------------------------------------------------------------
    -- Developers - put your upgrade statements here!
    -- -------------------------------------------------------------------------
    alter table ban
        add name varchar(512) null after id,
        add email varchar(190) null after name,
        add ip varbinary(16) null comment 'consider inet6_aton function' after email,
        add ipmask tinyint unsigned null comment 'CIDR mask' after ip,
        add useragent text null after ipmask,
        add action varchar(10) null after duration,
        add actiontarget varchar(40) null comment 'should be same datatype as request.status' after action,
        add visibility varchar(20) null comment 'should be same datatype as comment.visibility' after actiontarget;

    update ban set name = target where type = 'Name';
    update ban set ip = inet6_aton(target), ipmask = case when is_ipv6(target) then 128 else 32 end where type = 'IP';
    update ban set email = target where type = 'EMail';
    update ban set action = 'block', visibility = 'user';

    alter table ban
        drop index idx_ban_typeactive,
        modify column action varchar(10) not null,
        modify column visibility varchar(20) not null,
        drop column target,
        drop column type;

    drop index idx_ban_active on ban;
    create index idx_ban_active on ban (active desc, duration asc);


    CREATE TABLE netmask
    (
        protocol TINYINT UNSIGNED NOT NULL,
        cidr     TINYINT UNSIGNED NOT NULL,
        maskh   BIGINT UNSIGNED COMMENT 'High end of mask',
        maskl   BIGINT UNSIGNED NOT NULL COMMENT 'Low end of mask',

        CONSTRAINT netmask_pk PRIMARY KEY (protocol, cidr),
        CONSTRAINT netmask_protocol CHECK (protocol IN (4, 6)),
        CONSTRAINT netmask_cidr CHECK (CASE WHEN protocol = 4 THEN cidr <= 32 WHEN protocol = 6 THEN cidr <= 128 ELSE false END),
        CONSTRAINT netmask_type CHECK (CASE WHEN protocol = 6 THEN maskh IS NOT NULL ELSE true END)
    ) ENGINE=InnoDB;

    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,0,CONV('00000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,1,CONV('10000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,2,CONV('11000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,3,CONV('11100000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,4,CONV('11110000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,5,CONV('11111000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,6,CONV('11111100000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,7,CONV('11111110000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,8,CONV('11111111000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,9,CONV('11111111100000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,10,CONV('11111111110000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,11,CONV('11111111111000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,12,CONV('11111111111100000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,13,CONV('11111111111110000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,14,CONV('11111111111111000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,15,CONV('11111111111111100000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,16,CONV('11111111111111110000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,17,CONV('11111111111111111000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,18,CONV('11111111111111111100000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,19,CONV('11111111111111111110000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,20,CONV('11111111111111111111000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,21,CONV('11111111111111111111100000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,22,CONV('11111111111111111111110000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,23,CONV('11111111111111111111111000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,24,CONV('11111111111111111111111100000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,25,CONV('11111111111111111111111110000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,26,CONV('11111111111111111111111111000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,27,CONV('11111111111111111111111111100000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,28,CONV('11111111111111111111111111110000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,29,CONV('11111111111111111111111111111000',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,30,CONV('11111111111111111111111111111100',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,31,CONV('11111111111111111111111111111110',2,10));
    INSERT INTO netmask (protocol, cidr, maskl) VALUES (4,32,CONV('11111111111111111111111111111111',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,  0,CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,  1,CONV('1000000000000000000000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,  2,CONV('1100000000000000000000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,  3,CONV('1110000000000000000000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,  4,CONV('1111000000000000000000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,  5,CONV('1111100000000000000000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,  6,CONV('1111110000000000000000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,  7,CONV('1111111000000000000000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,  8,CONV('1111111100000000000000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,  9,CONV('1111111110000000000000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 10,CONV('1111111111000000000000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 11,CONV('1111111111100000000000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 12,CONV('1111111111110000000000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 13,CONV('1111111111111000000000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 14,CONV('1111111111111100000000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 15,CONV('1111111111111110000000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 16,CONV('1111111111111111000000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 17,CONV('1111111111111111100000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 18,CONV('1111111111111111110000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 19,CONV('1111111111111111111000000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 20,CONV('1111111111111111111100000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 21,CONV('1111111111111111111110000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 22,CONV('1111111111111111111111000000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 23,CONV('1111111111111111111111100000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 24,CONV('1111111111111111111111110000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 25,CONV('1111111111111111111111111000000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 26,CONV('1111111111111111111111111100000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 27,CONV('1111111111111111111111111110000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 28,CONV('1111111111111111111111111111000000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 29,CONV('1111111111111111111111111111100000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 30,CONV('1111111111111111111111111111110000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 31,CONV('1111111111111111111111111111111000000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 32,CONV('1111111111111111111111111111111100000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 33,CONV('1111111111111111111111111111111110000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 34,CONV('1111111111111111111111111111111111000000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 35,CONV('1111111111111111111111111111111111100000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 36,CONV('1111111111111111111111111111111111110000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 37,CONV('1111111111111111111111111111111111111000000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 38,CONV('1111111111111111111111111111111111111100000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 39,CONV('1111111111111111111111111111111111111110000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 40,CONV('1111111111111111111111111111111111111111000000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 41,CONV('1111111111111111111111111111111111111111100000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 42,CONV('1111111111111111111111111111111111111111110000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 43,CONV('1111111111111111111111111111111111111111111000000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 44,CONV('1111111111111111111111111111111111111111111100000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 45,CONV('1111111111111111111111111111111111111111111110000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 46,CONV('1111111111111111111111111111111111111111111111000000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 47,CONV('1111111111111111111111111111111111111111111111100000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 48,CONV('1111111111111111111111111111111111111111111111110000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 49,CONV('1111111111111111111111111111111111111111111111111000000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 50,CONV('1111111111111111111111111111111111111111111111111100000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 51,CONV('1111111111111111111111111111111111111111111111111110000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 52,CONV('1111111111111111111111111111111111111111111111111111000000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 53,CONV('1111111111111111111111111111111111111111111111111111100000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 54,CONV('1111111111111111111111111111111111111111111111111111110000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 55,CONV('1111111111111111111111111111111111111111111111111111111000000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 56,CONV('1111111111111111111111111111111111111111111111111111111100000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 57,CONV('1111111111111111111111111111111111111111111111111111111110000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 58,CONV('1111111111111111111111111111111111111111111111111111111111000000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 59,CONV('1111111111111111111111111111111111111111111111111111111111100000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 60,CONV('1111111111111111111111111111111111111111111111111111111111110000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 61,CONV('1111111111111111111111111111111111111111111111111111111111111000',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 62,CONV('1111111111111111111111111111111111111111111111111111111111111100',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 63,CONV('1111111111111111111111111111111111111111111111111111111111111110',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 64,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('0000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 65,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1000000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 66,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1100000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 67,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1110000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 68,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111000000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 69,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111100000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 70,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111110000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 71,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111000000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 72,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111100000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 73,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111110000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 74,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111000000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 75,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111100000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 76,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111110000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 77,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111000000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 78,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111100000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 79,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111110000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 80,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111000000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 81,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111100000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 82,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111110000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 83,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111000000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 84,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111100000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 85,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111110000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 86,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111000000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 87,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111100000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 88,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111110000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 89,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111000000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 90,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111100000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 91,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111110000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 92,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111000000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 93,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111100000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 94,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111110000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 95,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111000000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 96,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111100000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 97,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111110000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 98,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111000000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6, 99,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111100000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,100,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111110000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,101,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111000000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,102,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111100000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,103,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111110000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,104,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111000000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,105,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111100000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,106,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111110000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,107,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111000000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,108,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111100000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,109,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111110000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,110,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111111000000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,111,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111111100000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,112,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111111110000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,113,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111111111000000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,114,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111111111100000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,115,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111111111110000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,116,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111111111111000000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,117,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111111111111100000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,118,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111111111111110000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,119,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111111111111111000000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,120,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111111111111111100000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,121,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111111111111111110000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,122,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111111111111111111000000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,123,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111111111111111111100000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,124,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111111111111111111110000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,125,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111111111111111111111000',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,126,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111111111111111111111100',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,127,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111111111111111111111110',2,10));
    INSERT INTO netmask (protocol, cidr, maskh, maskl) VALUES (6,128,CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10),CONV('1111111111111111111111111111111111111111111111111111111111111111',2,10));


    -- -------------------------------------------------------------------------
    -- finally, update the schema version to indicate success
    UPDATE schemaversion SET version = patchversion;
END;;
DELIMITER ';'
CALL SCHEMA_UPGRADE_SCRIPT();
DROP PROCEDURE IF EXISTS SCHEMA_UPGRADE_SCRIPT;